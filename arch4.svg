<svg viewBox="0 0 2000 4500" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="1000" y="40" font-size="36" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    Modern Vulkan Renderer - Complete Architecture
  </text>
  <text x="1000" y="75" font-size="16" text-anchor="middle" fill="#7f8c8d">
    Triple-buffered, GPU-driven, Bindless, Multi-threaded Pipeline
  </text>
  
  <!-- ===== INITIALIZATION PHASE ===== -->
  <rect x="30" y="100" width="1940" height="450" fill="#e8f4f8" stroke="#3498db" stroke-width="3" rx="10"/>
  <text x="1000" y="140" font-size="26" font-weight="bold" text-anchor="middle" fill="#2980b9">
    INITIALIZATION PHASE (Startup)
  </text>
  
  <!-- Device Setup -->
  <g transform="translate(60, 170)">
    <rect x="0" y="0" width="450" height="350" fill="#fff" stroke="#3498db" stroke-width="2" rx="6"/>
    <text x="225" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#2980b9">
      1. Device &amp; Queue Setup
    </text>
    
    <rect x="20" y="50" width="410" height="280" fill="#ecf0f1" stroke="#3498db" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="12" fill="#2c3e50">• Create VkInstance with validation</text>
    <text x="30" y="95" font-size="12" fill="#2c3e50">• Pick VkPhysicalDevice (GPU)</text>
    <text x="40" y="115" font-size="11" fill="#7f8c8d">- Check features: descriptor indexing,</text>
    <text x="40" y="130" font-size="11" fill="#7f8c8d">  draw indirect count, buffer device address</text>
    <text x="40" y="145" font-size="11" fill="#7f8c8d">- Check limits: max descriptor sets,</text>
    <text x="40" y="160" font-size="11" fill="#7f8c8d">  max storage buffers, max samplers</text>
    <text x="30" y="180" font-size="12" fill="#2c3e50">• Create VkDevice with extensions:</text>
    <text x="40" y="200" font-size="11" font-family="monospace" fill="#27ae60">VK_KHR_swapchain</text>
    <text x="40" y="215" font-size="11" font-family="monospace" fill="#27ae60">VK_EXT_descriptor_indexing</text>
    <text x="40" y="230" font-size="11" font-family="monospace" fill="#27ae60">VK_KHR_draw_indirect_count</text>
    <text x="40" y="245" font-size="11" font-family="monospace" fill="#27ae60">VK_KHR_buffer_device_address</text>
    <text x="40" y="260" font-size="11" font-family="monospace" fill="#27ae60">VK_KHR_synchronization2</text>
    <text x="30" y="280" font-size="12" fill="#2c3e50">• Get queue families:</text>
    <text x="40" y="300" font-size="11" fill="#7f8c8d">Graphics, Compute, Transfer, Present</text>
  </g>
  
  <!-- Memory Management -->
  <g transform="translate(540, 170)">
    <rect x="0" y="0" width="450" height="350" fill="#fff" stroke="#3498db" stroke-width="2" rx="6"/>
    <text x="225" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#2980b9">
      2. Memory Management
    </text>
    
    <rect x="20" y="50" width="410" height="280" fill="#ecf0f1" stroke="#3498db" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="12" fill="#2c3e50">• Setup VMA (Vulkan Memory Allocator)</text>
    <text x="30" y="95" font-size="12" fill="#2c3e50">• Create memory pools:</text>
    
    <rect x="40" y="105" width="360" height="40" fill="#3498db" stroke="#2980b9" stroke-width="1" rx="3"/>
    <text x="50" y="125" font-size="11" font-weight="bold" fill="#fff">GPU-Only Memory</text>
    <text x="50" y="140" font-size="10" fill="#ecf0f1">Textures, RT, Vertex/Index buffers</text>
    
    <rect x="40" y="155" width="360" height="40" fill="#27ae60" stroke="#229954" stroke-width="1" rx="3"/>
    <text x="50" y="175" font-size="11" font-weight="bold" fill="#fff">CPU-to-GPU Staging</text>
    <text x="50" y="190" font-size="10" fill="#ecf0f1">Upload buffers, dynamic uniforms</text>
    
    <rect x="40" y="205" width="360" height="40" fill="#f39c12" stroke="#d68910" stroke-width="1" rx="3"/>
    <text x="50" y="225" font-size="11" font-weight="bold" fill="#fff">GPU-to-CPU Readback</text>
    <text x="50" y="240" font-size="10" fill="#2c3e50">Query results, debug captures</text>
    
    <text x="30" y="265" font-size="12" fill="#2c3e50">• Ring buffer allocators for dynamic data</text>
    <text x="30" y="285" font-size="12" fill="#2c3e50">• Chunk-based allocator for static meshes</text>
    <text x="30" y="305" font-size="12" fill="#2c3e50">• Texture streaming manager</text>
  </g>
  
  <!-- Resource Creation -->
  <g transform="translate(1020, 170)">
    <rect x="0" y="0" width="450" height="350" fill="#fff" stroke="#3498db" stroke-width="2" rx="6"/>
    <text x="225" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#2980b9">
      3. Core Resources
    </text>
    
    <rect x="20" y="50" width="410" height="280" fill="#ecf0f1" stroke="#3498db" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="12" fill="#2c3e50">• Swapchain (triple-buffered)</text>
    <text x="30" y="95" font-size="12" fill="#2c3e50">• Command pools (per thread):</text>
    <text x="40" y="115" font-size="11" fill="#7f8c8d">- Graphics pool × threads</text>
    <text x="40" y="130" font-size="11" fill="#7f8c8d">- Compute pool × threads</text>
    <text x="40" y="145" font-size="11" fill="#7f8c8d">- Transfer pool</text>
    <text x="30" y="165" font-size="12" fill="#2c3e50">• Descriptor pools:</text>
    <text x="40" y="185" font-size="11" fill="#7f8c8d">- Global bindless pool (large)</text>
    <text x="40" y="200" font-size="11" fill="#7f8c8d">- Per-frame dynamic pools</text>
    <text x="30" y="220" font-size="12" fill="#2c3e50">• Synchronization objects:</text>
    <text x="40" y="240" font-size="11" fill="#7f8c8d">- Semaphores (image available, render done)</text>
    <text x="40" y="255" font-size="11" fill="#7f8c8d">- Fences (frame in-flight × 3)</text>
    <text x="40" y="270" font-size="11" fill="#7f8c8d">- Timeline semaphores for async work</text>
    <text x="30" y="290" font-size="12" fill="#2c3e50">• Query pools (timestamps, pipeline stats)</text>
    <text x="30" y="310" font-size="12" fill="#2c3e50">• Global render passes &amp; framebuffers</text>
  </g>
  
  <!-- Pipeline Setup -->
  <g transform="translate(1500, 170)">
    <rect x="0" y="0" width="450" height="350" fill="#fff" stroke="#3498db" stroke-width="2" rx="6"/>
    <text x="225" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#2980b9">
      4. Pipeline Setup
    </text>
    
    <rect x="20" y="50" width="410" height="280" fill="#ecf0f1" stroke="#3498db" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="12" fill="#2c3e50">• Descriptor set layouts:</text>
    <text x="40" y="95" font-size="11" fill="#7f8c8d">Set 0: Global bindless (materials,</text>
    <text x="40" y="110" font-size="11" fill="#7f8c8d">       textures[], transforms, vertices)</text>
    <text x="40" y="125" font-size="11" fill="#7f8c8d">Set 1: Per-pass (lighting data)</text>
    <text x="40" y="140" font-size="11" fill="#7f8c8d">Set 2: Per-technique (optional)</text>
    <text x="30" y="160" font-size="12" fill="#2c3e50">• Pipeline layouts with push constants</text>
    <text x="30" y="180" font-size="12" fill="#2c3e50">• Graphics pipelines:</text>
    <text x="40" y="200" font-size="11" fill="#7f8c8d">- Depth pre-pass, GBuffer, Forward+</text>
    <text x="40" y="215" font-size="11" fill="#7f8c8d">- Transparent, Post-process</text>
    <text x="40" y="230" font-size="11" fill="#7f8c8d">- Shadow mapping (cascade × 4)</text>
    <text x="30" y="250" font-size="12" fill="#2c3e50">• Compute pipelines:</text>
    <text x="40" y="270" font-size="11" fill="#7f8c8d">- GPU culling, LOD selection</text>
    <text x="40" y="285" font-size="11" fill="#7f8c8d">- Light clustering, SSAO, SSR</text>
    <text x="30" y="305" font-size="12" fill="#2c3e50">• Pipeline cache for fast loading</text>
  </g>
  
  <!-- ===== FRAME LOOP STRUCTURE ===== -->
  <rect x="30" y="580" width="1940" height="380" fill="#fff9e6" stroke="#f39c12" stroke-width="3" rx="10"/>
  <text x="1000" y="620" font-size="26" font-weight="bold" text-anchor="middle" fill="#d68910">
    FRAME STRUCTURE - Triple Buffering
  </text>
  <text x="1000" y="650" font-size="14" text-anchor="middle" fill="#7f8c8d">
    CPU and GPU work on different frames simultaneously
  </text>
  
  <!-- Triple buffer timeline -->
  <g transform="translate(60, 680)">
    <text x="0" y="0" font-size="16" font-weight="bold" fill="#2c3e50">Time →</text>
    
    <!-- Frame N-2 -->
    <rect x="100" y="-20" width="500" height="60" fill="#95a5a6" stroke="#7f8c8d" stroke-width="2" rx="4"/>
    <text x="350" y="10" font-size="14" font-weight="bold" text-anchor="middle" fill="#fff">Frame N-2 (GPU Executing)</text>
    <text x="350" y="30" font-size="11" text-anchor="middle" fill="#ecf0f1">Rendering to screen, resources LOCKED</text>
    
    <!-- Frame N-1 -->
    <rect x="100" y="60" width="500" height="60" fill="#3498db" stroke="#2980b9" stroke-width="2" rx="4"/>
    <text x="350" y="90" font-size="14" font-weight="bold" text-anchor="middle" fill="#fff">Frame N-1 (GPU Processing)</text>
    <text x="350" y="110" font-size="11" text-anchor="middle" fill="#ecf0f1">Commands submitted, waiting for GPU</text>
    
    <!-- Frame N -->
    <rect x="100" y="140" width="500" height="60" fill="#27ae60" stroke="#229954" stroke-width="2" rx="4"/>
    <text x="350" y="170" font-size="14" font-weight="bold" text-anchor="middle" fill="#fff">Frame N (CPU Recording)</text>
    <text x="350" y="190" font-size="11" text-anchor="middle" fill="#ecf0f1">Building command buffers, resources FREE</text>
    
    <!-- Arrows showing progression -->
    <path d="M 620 10 L 700 10 L 700 90 L 620 90" stroke="#e74c3c" stroke-width="3" fill="none" marker-end="url(#arrow-red)"/>
    <path d="M 620 90 L 700 90 L 700 170 L 620 170" stroke="#e74c3c" stroke-width="3" fill="none" marker-end="url(#arrow-red)"/>
    <text x="720" y="50" font-size="12" fill="#e74c3c">Next</text>
    <text x="720" y="130" font-size="12" fill="#e74c3c">Frame</text>
    
    <!-- Frame resources -->
    <rect x="750" y="-20" width="580" height="220" fill="#fff" stroke="#f39c12" stroke-width="2" rx="4"/>
    <text x="1040" y="10" font-size="14" font-weight="bold" text-anchor="middle" fill="#d68910">
      Per-Frame Resources (× 3)
    </text>
    <text x="760" y="40" font-size="12" fill="#2c3e50">• Command buffers (primary + secondary)</text>
    <text x="760" y="60" font-size="12" fill="#2c3e50">• Dynamic uniform buffers (ring allocated)</text>
    <text x="760" y="80" font-size="12" fill="#2c3e50">• Descriptor sets (dynamic pool)</text>
    <text x="760" y="100" font-size="12" fill="#2c3e50">• Query pools (timestamps)</text>
    <text x="760" y="120" font-size="12" fill="#2c3e50">• Fence (signals when GPU done)</text>
    <text x="760" y="140" font-size="12" fill="#2c3e50">• Semaphores (image acquire, render complete)</text>
    <text x="760" y="160" font-size="12" fill="#2c3e50">• Scratch buffers for async uploads</text>
    <text x="760" y="180" font-size="12" fill="#2c3e50">• GPU-visible buffers (indirect, culling)</text>
  </g>
  
  <!-- ===== CPU FRAME PROCESSING ===== -->
  <rect x="30" y="990" width="1940" height="650" fill="#e8f8e8" stroke="#27ae60" stroke-width="3" rx="10"/>
  <text x="1000" y="1030" font-size="26" font-weight="bold" text-anchor="middle" fill="#229954">
    CPU FRAME PROCESSING (Multi-threaded)
  </text>
  
  <!-- Frame start -->
  <g transform="translate(60, 1060)">
    <rect x="0" y="0" width="1880" height="100" fill="#fff" stroke="#27ae60" stroke-width="2" rx="6"/>
    <text x="940" y="30" font-size="18" font-weight="bold" text-anchor="middle" fill="#229954">
      Frame Start: Wait &amp; Acquire
    </text>
    
    <g transform="translate(30, 50)">
      <text x="0" y="0" font-size="13" fill="#2c3e50">1. </text>
      <text x="30" y="0" font-size="13" font-family="monospace" fill="#2c3e50">vkWaitForFences(frameInFlight[N % 3])</text>
      <text x="450" y="0" font-size="12" fill="#7f8c8d">← Wait until Frame N-3 finished on GPU</text>
      
      <text x="0" y="25" font-size="13" fill="#2c3e50">2. </text>
      <text x="30" y="25" font-size="13" font-family="monospace" fill="#2c3e50">vkResetCommandPool(pool[N % 3])</text>
      <text x="450" y="25" font-size="12" fill="#7f8c8d">← Free all command buffers for reuse</text>
      
      <text x="0" y="50" font-size="13" fill="#2c3e50">3. </text>
      <text x="30" y="50" font-size="13" font-family="monospace" fill="#2c3e50">vkAcquireNextImageKHR()</text>
      <text x="450" y="50" font-size="12" fill="#7f8c8d">← Get next swapchain image index</text>
    </g>
  </g>
  
  <!-- Scene update -->
  <g transform="translate(60, 1180)">
    <rect x="0" y="0" width="600" height="220" fill="#fff" stroke="#27ae60" stroke-width="2" rx="6"/>
    <text x="300" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#229954">
      Scene Update (Main Thread)
    </text>
    
    <rect x="20" y="50" width="560" height="150" fill="#ecf0f1" stroke="#27ae60" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="12" fill="#2c3e50">• Process input, update camera</text>
    <text x="30" y="95" font-size="12" fill="#2c3e50">• Run gameplay/ECS systems</text>
    <text x="30" y="115" font-size="12" fill="#2c3e50">• Frustum culling (coarse, per-object)</text>
    <text x="30" y="135" font-size="12" fill="#2c3e50">• Update transforms, animations</text>
    <text x="30" y="155" font-size="12" fill="#2c3e50">• Add/remove objects from render list</text>
    <text x="30" y="175" font-size="12" fill="#2c3e50">• Build spatial acceleration structures</text>
  </g>
  
  <!-- Resource updates -->
  <g transform="translate(680, 1180)">
    <rect x="0" y="0" width="600" height="220" fill="#fff" stroke="#27ae60" stroke-width="2" rx="6"/>
    <text x="300" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#229954">
      Resource Updates
    </text>
    
    <rect x="20" y="50" width="560" height="150" fill="#ecf0f1" stroke="#27ae60" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="12" fill="#2c3e50">• Update global uniform buffer:</text>
    <text x="40" y="95" font-size="11" fill="#7f8c8d">View/Proj matrices, time, resolution</text>
    <text x="30" y="115" font-size="12" fill="#2c3e50">• Update storage buffers (ring allocate):</text>
    <text x="40" y="135" font-size="11" fill="#7f8c8d">Materials, Transforms, DrawData</text>
    <text x="30" y="155" font-size="12" fill="#2c3e50">• Stream textures (async transfer queue)</text>
    <text x="30" y="175" font-size="12" fill="#2c3e50">• Update descriptor arrays (bindless)</text>
  </g>
  
  <!-- Parallel command recording -->
  <g transform="translate(1300, 1180)">
    <rect x="0" y="0" width="640" height="220" fill="#fff" stroke="#27ae60" stroke-width="2" rx="6"/>
    <text x="320" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#229954">
      Parallel Preparation
    </text>
    
    <rect x="20" y="50" width="600" height="150" fill="#ecf0f1" stroke="#27ae60" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="12" fill="#2c3e50">• Sort render lists by pipeline/material</text>
    <text x="30" y="95" font-size="12" fill="#2c3e50">• Bucket objects for GPU culling:</text>
    <text x="40" y="115" font-size="11" fill="#7f8c8d">Opaque, Transparent, Shadow casters</text>
    <text x="30" y="135" font-size="12" fill="#2c3e50">• Prepare indirect draw buffers</text>
    <text x="30" y="155" font-size="12" fill="#2c3e50">• Upload object data for GPU culling</text>
    <text x="30" y="175" font-size="12" fill="#2c3e50">• Build light lists, probe updates</text>
  </g>
  
  <!-- Multi-threaded command recording -->
  <g transform="translate(60, 1420)">
    <rect x="0" y="0" width="1880" height="200" fill="#fff" stroke="#3498db" stroke-width="2" rx="6"/>
    <text x="940" y="30" font-size="18" font-weight="bold" text-anchor="middle" fill="#2980b9">
      Multi-threaded Command Buffer Recording
    </text>
    
    <!-- Thread 0 -->
    <rect x="30" y="50" width="420" height="130" fill="#3498db" stroke="#2980b9" stroke-width="2" rx="4"/>
    <text x="240" y="75" font-size="14" font-weight="bold" text-anchor="middle" fill="#fff">Thread 0 (Main)</text>
    <text x="40" y="100" font-size="11" fill="#ecf0f1">• Primary command buffer</text>
    <text x="40" y="118" font-size="11" fill="#ecf0f1">• GPU culling compute pass</text>
    <text x="40" y="136" font-size="11" fill="#ecf0f1">• Begin render pass</text>
    <text x="40" y="154" font-size="11" fill="#ecf0f1">• Execute secondary buffers</text>
    <text x="40" y="172" font-size="11" fill="#ecf0f1">• Post-process, UI</text>
    
    <!-- Thread 1 -->
    <rect x="470" y="50" width="420" height="130" fill="#27ae60" stroke="#229954" stroke-width="2" rx="4"/>
    <text x="680" y="75" font-size="14" font-weight="bold" text-anchor="middle" fill="#fff">Thread 1</text>
    <text x="480" y="100" font-size="11" fill="#ecf0f1">• Secondary cmd buffer</text>
    <text x="480" y="118" font-size="11" fill="#ecf0f1">• Depth pre-pass chunk 1</text>
    <text x="480" y="136" font-size="11" fill="#ecf0f1">• GBuffer pass chunk 1</text>
    <text x="480" y="154" font-size="11" fill="#ecf0f1">• Multi-draw indirect calls</text>
    
    <!-- Thread 2 -->
    <rect x="910" y="50" width="420" height="130" fill="#27ae60" stroke="#229954" stroke-width="2" rx="4"/>
    <text x="1120" y="75" font-size="14" font-weight="bold" text-anchor="middle" fill="#fff">Thread 2</text>
    <text x="920" y="100" font-size="11" fill="#ecf0f1">• Secondary cmd buffer</text>
    <text x="920" y="118" font-size="11" fill="#ecf0f1">• Depth pre-pass chunk 2</text>
    <text x="920" y="136" font-size="11" fill="#ecf0f1">• GBuffer pass chunk 2</text>
    <text x="920" y="154" font-size="11" fill="#ecf0f1">• Shadow map cascades</text>
    
    <!-- Thread 3 -->
    <rect x="1350" y="50" width="420" height="130" fill="#27ae60" stroke="#229954" stroke-width="2" rx="4"/>
    <text x="1560" y="75" font-size="14" font-weight="bold" text-anchor="middle" fill="#fff">Thread 3</text>
    <text x="1360" y="100" font-size="11" fill="#ecf0f1">• Secondary cmd buffer</text>
    <text x="1360" y="118" font-size="11" fill="#ecf0f1">• Transparent objects</text>
    <text x="1360" y="136" font-size="11" fill="#ecf0f1">• Particle systems</text>
    <text x="1360" y="154" font-size="11" fill="#ecf0f1">• VFX, decals</text>
  </g>
  
  <!-- ===== GPU PIPELINE ===== -->
  <rect x="30" y="1670" width="1940" height="1400" fill="#f0e8f8" stroke="#9b59b6" stroke-width="3" rx="10"/>
  <text x="1000" y="1710" font-size="26" font-weight="bold" text-anchor="middle" fill="#8e44ad">
    GPU RENDERING PIPELINE
  </text>
  
  <!-- Submit -->
  <g transform="translate(60, 1740)">
    <rect x="0" y="0" width="1880" height="80" fill="#fff" stroke="#9b59b6" stroke-width="2" rx="6"/>
    <text x="940" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#8e44ad">
      Command Submit
    </text>
    <text x="30" y="60" font-size="13" font-family="monospace" fill="#2c3e50">
      vkQueueSubmit2(graphicsQueue, {cmdBuffers, waitSemaphore: imageAvailable, signalSemaphore: renderComplete, fence: frameInFlight[N]})
    </text>
  </g>
  
  <!-- GPU Compute Culling -->
  <g transform="translate(60, 1840)">
    <rect x="0" y="0" width="600" height="180" fill="#fff" stroke="#9b59b6" stroke-width="2" rx="6"/>
    <text x="300" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#8e44ad">
      1. GPU Culling (Compute)
    </text>
    
    <rect x="20" y="50" width="560" height="110" fill="#34495e" stroke="#9b59b6" stroke-width="1" rx="4"/>
    <text x="30" y="70" font-size="11" font-family="monospace" fill="#52c9a5">// Parallel: 64 threads/group</text>
    <text x="30" y="88" font-size="11" font-family="monospace" fill="#fff">for each object (parallel):</text>
    <text x="40" y="106" font-size="11" font-family="monospace" fill="#fff">  if frustumTest && occlusionTest:</text>
    <text x="50" y="124" font-size="11" font-family="monospace" fill="#27ae60">    LOD = selectLOD(distance)</text>
    <text x="50" y="142" font-size="11" font-family="monospace" fill="#27ae60">    atomicAdd(drawCount[pipeline])</text>
    <text x="50" y="160" font-size="11" font-family="monospace" fill="#27ae60">    writeDrawCommand()</text>
  </g>
  
  <!-- Depth Pre-pass -->
  <g transform="translate(680, 1840)">
    <rect x="0" y="0" width="600" height="180" fill="#fff" stroke="#9b59b6" stroke-width="2" rx="6"/>
    <text x="300" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#8e44ad">
      2. Depth Pre-pass
    </text>
    
    <rect x="20" y="50" width="560" height="110" fill="#ecf0f1" stroke="#9b59b6" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="12" fill="#2c3e50">• Early depth test, no color writes</text>
    <text x="30" y="95" font-size="12" fill="#2c3e50">• Build Hi-Z pyramid for next frame</text>
    <text x="30" y="115" font-size="12" fill="#2c3e50">• Multi-draw indirect (GPU culled)</text>
    <text x="30" y="135" font-size="12" fill="#27ae60">Output: Depth buffer (full resolution)</text>
  </g>
  
  <!-- Shadow mapping -->
  <g transform="translate(1300, 1840)">
    <rect x="0" y="0" width="640" height="180" fill="#fff" stroke="#9b59b6" stroke-width="2" rx="6"/>
    <text x="320" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#8e44ad">
      3. Shadow Maps (Parallel)
    </text>
    
    <rect x="20" y="50" width="600" height="110" fill="#ecf0f1" stroke="#9b59b6" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="12" fill="#2c3e50">• Cascade shadow maps × 4</text>
    <text x="30" y="95" font-size="12" fill="#2c3e50">• Point light shadows (cubemap)</text>
    <text x="30" y="115" font-size="12" fill="#2c3e50">• Spot light shadows</text>
    <text x="30" y="135" font-size="12" fill="#27ae60">Output: Shadow atlas (4096×4096)</text>
  </g>
  
  <!-- GBuffer pass -->
  <g transform="translate(60, 2040)">
    <rect x="0" y="0" width="920" height="220" fill="#fff" stroke="#9b59b6" stroke-width="2" rx="6"/>
    <text x="460" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#8e44ad">
      4. GBuffer Pass (Deferred)
    </text>
    
    <rect x="20" y="50" width="880" height="150" fill="#ecf0f1" stroke="#9b59b6" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="12" fill="#2c3e50">• Bind global descriptor set (bindless)</text>
    <text x="30" y="95" font-size="12" fill="#2c3e50">• Multi-draw indirect (depth tested, GPU culled)</text>
    <text x="30" y="115" font-size="12" fill="#2c3e50">• Vertex shader: manual fetch, bindless transforms</text>
    <text x="30" y="135" font-size="12" fill="#2c3e50">• Fragment shader: bindless material/textures</text>
    <text x="30" y="155" font-size="12" fill="#27ae60">Outputs:</text>
    <text x="40" y="175" font-size="11" fill="#27ae60">RT0: Albedo (RGB) + Metallic (A)</text>
    <text x="40" y="190" font-size="11" fill="#27ae60">RT1: Normal (RGB) + Roughness (A)</text>
    <text x="40" y="205" font-size="11" fill="#27ae60">RT2: Velocity (RG) + AO (B)</text>
  </g>
  
  <!-- Lighting compute -->
  <g transform="translate(1000, 2040)">
    <rect x="0" y="0" width="940" height="220" fill="#fff" stroke="#9b59b6" stroke-width="2" rx="6"/>
    <text x="470" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#8e44ad">
      5. Lighting (Compute/Tiled)
    </text>
    
    <rect x="20" y="50" width="900" height="150" fill="#34495e" stroke="#9b59b6" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="12" fill="#fff">• Tiled/Clustered lighting (16×16 tiles)</text>
    <text x="30" y="95" font-size="12" fill="#fff">• Build light lists per tile (shared memory)</text>
    <text x="30" y="115" font-size="12" fill="#fff">• Sample GBuffer, shadow maps</text>
    <text x="30" y="135" font-size="12" fill="#fff">• PBR shading (Cook-Torrance)</text>
    <text x="30" y="155" font-size="12" fill="#fff">• Apply indirect lighting (reflection probes)</text>
    <text x="30" y="175" font-size="12" fill="#27ae60">Output: HDR color buffer</text>
  </g>
  
  <!-- SSAO -->
  <g transform="translate(60, 2280)">
    <rect x="0" y="0" width="600" height="140" fill="#fff" stroke="#9b59b6" stroke-width="2" rx="6"/>
    <text x="300" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#8e44ad">
      6. SSAO (Compute)
    </text>
    
    <rect x="20" y="50" width="560" height="70" fill="#ecf0f1" stroke="#9b59b6" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="12" fill="#2c3e50">• Sample depth/normal buffer</text>
    <text x="30" y="95" font-size="12" fill="#2c3e50">• Hemisphere sampling</text>
    <text x="30" y="115" font-size="12" fill="#27ae60">• Bilateral blur → AO buffer</text>
  </g>
  
  <!-- SSR -->
  <g transform="translate(680, 2280)">
    <rect x="0" y="0" width="600" height="140" fill="#fff" stroke="#9b59b6" stroke-width="2" rx="6"/>
    <text x="300" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#8e44ad">
      7. SSR (Compute)
    </text>
    
    <rect x="20" y="50" width="560" height="70" fill="#ecf0f1" stroke="#9b59b6" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="12" fill="#2c3e50">• Ray march in screen space</text>
    <text x="30" y="95" font-size="12" fill="#2c3e50">• Use Hi-Z for acceleration</text>
    <text x="30" y="115" font-size="12" fill="#27ae60">• Reflection buffer (RGBA)</text>
  </g>
  
  <!-- Transparent -->
  <g transform="translate(1300, 2280)">
    <rect x="0" y="0" width="640" height="140" fill="#fff" stroke="#9b59b6" stroke-width="2" rx="6"/>
    <text x="320" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#8e44ad">
      8. Forward+ Transparent
    </text>
    
    <rect x="20" y="50" width="600" height="70" fill="#ecf0f1" stroke="#9b59b6" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="12" fill="#2c3e50">• Sort back-to-front</text>
    <text x="30" y="95" font-size="12" fill="#2c3e50">• Forward lighting with tile data</text>
    <text x="30" y="115" font-size="12" fill="#27ae60">• Blend to HDR buffer</text>
  </g>
  
  <!-- Post-processing -->
  <g transform="translate(60, 2440)">
    <rect x="0" y="0" width="1880" height="240" fill="#fff" stroke="#9b59b6" stroke-width="2" rx="6"/>
    <text x="940" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#8e44ad">
      9. Post-Processing Chain
    </text>
    
    <g transform="translate(30, 50)">
      <rect x="0" y="0" width="270" height="50" fill="#e74c3c" stroke="#c0392b" stroke-width="1" rx="3"/>
      <text x="135" y="30" font-size="12" text-anchor="middle" fill="#fff">TAA (Temporal AA)</text>
      
      <path d="M 270 25 L 300 25" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arrow-gray)"/>
      
      <rect x="300" y="0" width="270" height="50" fill="#3498db" stroke="#2980b9" stroke-width="1" rx="3"/>
      <text x="435" y="30" font-size="12" text-anchor="middle" fill="#fff">Bloom (Compute)</text>
      
      <path d="M 570 25 L 600 25" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arrow-gray)"/>
      
      <rect x="600" y="0" width="270" height="50" fill="#27ae60" stroke="#229954" stroke-width="1" rx="3"/>
      <text x="735" y="30" font-size="12" text-anchor="middle" fill="#fff">DOF (Depth of Field)</text>
      
      <path d="M 870 25 L 900 25" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arrow-gray)"/>
      
      <rect x="900" y="0" width="270" height="50" fill="#f39c12" stroke="#d68910" stroke-width="1" rx="3"/>
      <text x="1035" y="30" font-size="12" text-anchor="middle" fill="#fff">Motion Blur</text>
      
      <path d="M 1170 25 L 1200 25" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arrow-gray)"/>
      
      <rect x="1200" y="0" width="270" height="50" fill="#9b59b6" stroke="#8e44ad" stroke-width="1" rx="3"/>
      <text x="1335" y="30" font-size="12" text-anchor="middle" fill="#fff">Auto Exposure</text>
      
      <path d="M 1470 25 L 1500 25" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arrow-gray)"/>
      
      <rect x="1500" y="0" width="270" height="50" fill="#e74c3c" stroke="#c0392b" stroke-width="1" rx="3"/>
      <text x="1635" y="30" font-size="12" text-anchor="middle" fill="#fff">Tone Mapping</text>
    </g>
    
    <g transform="translate(30, 120)">
      <rect x="0" y="0" width="400" height="50" fill="#95a5a6" stroke="#7f8c8d" stroke-width="1" rx="3"/>
      <text x="200" y="30" font-size="12" text-anchor="middle" fill="#fff">Color Grading (LUT)</text>
      
      <path d="M 400 25 L 450 25" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arrow-gray)"/>
      
      <rect x="450" y="0" width="400" height="50" fill="#34495e" stroke="#2c3e50" stroke-width="1" rx="3"/>
      <text x="650" y="30" font-size="12" text-anchor="middle" fill="#fff">FXAA / SMAA (optional)</text>
      
      <path d="M 850 25 L 900 25" stroke="#7f8c8d" stroke-width="2" marker-end="url(#arrow-gray)"/>
      
      <rect x="900" y="0" width="400" height="50" fill="#27ae60" stroke="#229954" stroke-width="2" rx="3"/>
      <text x="1100" y="22" font-size="13" font-weight="bold" text-anchor="middle" fill="#fff">Final Blit to Swapchain</text>
      <text x="1100" y="40" font-size="10" text-anchor="middle" fill="#ecf0f1">(sRGB conversion)</text>
    </g>
  </g>
  
  <!-- UI/Debug overlay -->
  <g transform="translate(60, 2700)">
    <rect x="0" y="0" width="920" height="140" fill="#fff" stroke="#9b59b6" stroke-width="2" rx="6"/>
    <text x="460" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#8e44ad">
      10. UI &amp; Debug Overlay
    </text>
    
    <rect x="20" y="50" width="880" height="70" fill="#ecf0f1" stroke="#9b59b6" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="12" fill="#2c3e50">• Render UI quads (ImGui/custom)</text>
    <text x="30" y="95" font-size="12" fill="#2c3e50">• Debug visualizations (wireframe, bounds)</text>
    <text x="30" y="115" font-size="12" fill="#2c3e50">• Text rendering (signed distance fields)</text>
  </g>
  
  <!-- Present -->
  <g transform="translate(1000, 2700)">
    <rect x="0" y="0" width="940" height="140" fill="#fff" stroke="#9b59b6" stroke-width="2" rx="6"/>
    <text x="470" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#8e44ad">
      11. Present
    </text>
    
    <rect x="20" y="50" width="900" height="70" fill="#ecf0f1" stroke="#9b59b6" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="12" font-family="monospace" fill="#2c3e50">vkQueuePresentKHR(presentQueue,</text>
    <text x="40" y="95" font-size="12" font-family="monospace" fill="#2c3e50">  {swapchain, imageIndex,</text>
    <text x="40" y="115" font-size="12" font-family="monospace" fill="#2c3e50">   waitSemaphore: renderComplete})</text>
  </g>
  
  <!-- Async operations -->
  <g transform="translate(60, 2860)">
    <rect x="0" y="0" width="1880" height="190" fill="#fff9e6" stroke="#f39c12" stroke-width="2" rx="6"/>
    <text x="940" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#d68910">
      Asynchronous Operations (Parallel to Rendering)
    </text>
    
    <g transform="translate(30, 50)">
      <rect x="0" y="0" width="580" height="120" fill="#3498db" stroke="#2980b9" stroke-width="1" rx="3"/>
      <text x="290" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="#fff">Transfer Queue</text>
      <text x="20" y="50" font-size="11" fill="#ecf0f1">• Texture streaming (async)</text>
      <text x="20" y="68" font-size="11" fill="#ecf0f1">• Mesh uploads</text>
      <text x="20" y="86" font-size="11" fill="#ecf0f1">• Buffer updates</text>
      <text x="20" y="104" font-size="11" fill="#ecf0f1">Timeline semaphore sync</text>
      
      <rect x="620" y="0" width="580" height="120" fill="#9b59b6" stroke="#8e44ad" stroke-width="1" rx="3"/>
      <text x="910" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="#fff">Compute Queue</text>
      <text x="640" y="50" font-size="11" fill="#ecf0f1">• Particle simulation</text>
      <text x="640" y="68" font-size="11" fill="#ecf0f1">• Cloth/physics</text>
      <text x="640" y="86" font-size="11" fill="#ecf0f1">• Async compute (SSAO, etc.)</text>
      <text x="640" y="104" font-size="11" fill="#ecf0f1">Overlap with graphics</text>
      
      <rect x="1240" y="0" width="580" height="120" fill="#27ae60" stroke="#229954" stroke-width="1" rx="3"/>
      <text x="1530" y="25" font-size="14" font-weight="bold" text-anchor="middle" fill="#fff">CPU Background</text>
      <text x="1260" y="50" font-size="11" fill="#ecf0f1">• Shader compilation</text>
      <text x="1260" y="68" font-size="11" fill="#ecf0f1">• Asset loading/processing</text>
      <text x="1260" y="86" font-size="11" fill="#ecf0f1">• Texture compression</text>
      <text x="1260" y="104" font-size="11" fill="#ecf0f1">Job system tasks</text>
    </g>
  </g>
  
  <!-- ===== MEMORY & SYNC ===== -->
  <rect x="30" y="3100" width="1940" height="460" fill="#ffe8e8" stroke="#e74c3c" stroke-width="3" rx="10"/>
  <text x="1000" y="3140" font-size="26" font-weight="bold" text-anchor="middle" fill="#c0392b">
    SYNCHRONIZATION &amp; MEMORY BARRIERS
  </text>
  
  <!-- Synchronization primitives -->
  <g transform="translate(60, 3170)">
    <rect x="0" y="0" width="920" height="360" fill="#fff" stroke="#e74c3c" stroke-width="2" rx="6"/>
    <text x="460" y="30" font-size="18" font-weight="bold" text-anchor="middle" fill="#c0392b">
      Synchronization Primitives
    </text>
    
    <rect x="20" y="50" width="880" height="290" fill="#ecf0f1" stroke="#e74c3c" stroke-width="1" rx="4"/>
    
    <text x="30" y="75" font-size="14" font-weight="bold" fill="#2c3e50">Fences (CPU-GPU sync):</text>
    <text x="40" y="95" font-size="11" fill="#2c3e50">• frameInFlight[3] - Track frame completion</text>
    <text x="40" y="110" font-size="11" fill="#2c3e50">• Wait before reusing resources</text>
    
    <text x="30" y="140" font-size="14" font-weight="bold" fill="#2c3e50">Binary Semaphores (GPU-GPU):</text>
    <text x="40" y="160" font-size="11" fill="#2c3e50">• imageAvailable - Swapchain image ready</text>
    <text x="40" y="175" font-size="11" fill="#2c3e50">• renderComplete - Rendering finished</text>
    <text x="40" y="190" font-size="11" fill="#2c3e50">Order: Acquire → Render → Present</text>
    
    <text x="30" y="220" font-size="14" font-weight="bold" fill="#2c3e50">Timeline Semaphores:</text>
    <text x="40" y="240" font-size="11" fill="#2c3e50">• Async compute/transfer sync</text>
    <text x="40" y="255" font-size="11" fill="#2c3e50">• Value-based signaling</text>
    <text x="40" y="270" font-size="11" font-family="monospace" fill="#7f8c8d">signal(transferSem, value: 42)</text>
    <text x="40" y="285" font-size="11" font-family="monospace" fill="#7f8c8d">wait(graphicsSem, value: 42)</text>
    
    <text x="30" y="315" font-size="14" font-weight="bold" fill="#2c3e50">Events (Fine-grained):</text>
    <text x="40" y="335" font-size="11" fill="#2c3e50">• Intra-command buffer sync</text>
  </g>
  
  <!-- Pipeline barriers -->
  <g transform="translate(1000, 3170)">
    <rect x="0" y="0" width="940" height="360" fill="#fff" stroke="#e74c3c" stroke-width="2" rx="6"/>
    <text x="470" y="30" font-size="18" font-weight="bold" text-anchor="middle" fill="#c0392b">
      Pipeline Barriers &amp; Memory
    </text>
    
    <rect x="20" y="50" width="900" height="290" fill="#ecf0f1" stroke="#e74c3c" stroke-width="1" rx="4"/>
    
    <text x="30" y="75" font-size="14" font-weight="bold" fill="#2c3e50">VkMemoryBarrier2 (Synchronization2):</text>
    <text x="40" y="95" font-size="11" font-family="monospace" fill="#2c3e50">srcStageMask: COMPUTE_SHADER</text>
    <text x="40" y="110" font-size="11" font-family="monospace" fill="#2c3e50">srcAccessMask: SHADER_WRITE</text>
    <text x="40" y="125" font-size="11" font-family="monospace" fill="#2c3e50">dstStageMask: FRAGMENT_SHADER</text>
    <text x="40" y="140" font-size="11" font-family="monospace" fill="#2c3e50">dstAccessMask: SHADER_READ</text>
    
    <text x="30" y="170" font-size="14" font-weight="bold" fill="#2c3e50">Image Layout Transitions:</text>
    <text x="40" y="190" font-size="11" fill="#2c3e50">• UNDEFINED → DEPTH_ATTACHMENT</text>
    <text x="40" y="205" font-size="11" fill="#2c3e50">• COLOR_ATTACHMENT → SHADER_READ</text>
    <text x="40" y="220" font-size="11" fill="#2c3e50">• TRANSFER_DST → SHADER_READ</text>
    <text x="40" y="235" font-size="11" fill="#2c3e50">• SHADER_READ → PRESENT_SRC</text>
    
    <text x="30" y="265" font-size="14" font-weight="bold" fill="#2c3e50">Common Hazards:</text>
    <text x="40" y="285" font-size="11" fill="#e74c3c">WAR: Write After Read</text>
    <text x="40" y="300" font-size="11" fill="#e74c3c">RAW: Read After Write (most common)</text>
    <text x="40" y="315" font-size="11" fill="#e74c3c">WAW: Write After Write</text>
    <text x="40" y="335" font-size="11" fill="#7f8c8d">→ Use barriers between passes!</text>
  </g>
  
  <!-- ===== PROFILING & DEBUG ===== -->
  <rect x="30" y="3590" width="1940" height="380" fill="#e8f8e8" stroke="#34495e" stroke-width="3" rx="10"/>
  <text x="1000" y="3630" font-size="26" font-weight="bold" text-anchor="middle" fill="#2c3e50">
    PROFILING &amp; DEBUGGING
  </text>
  
  <g transform="translate(60, 3660)">
    <!-- Timestamp queries -->
    <rect x="0" y="0" width="600" height="280" fill="#fff" stroke="#34495e" stroke-width="2" rx="6"/>
    <text x="300" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#2c3e50">
      GPU Profiling
    </text>
    
    <rect x="20" y="50" width="560" height="210" fill="#ecf0f1" stroke="#34495e" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="12" fill="#2c3e50">• Timestamp queries:</text>
    <text x="40" y="95" font-size="11" font-family="monospace" fill="#7f8c8d">vkCmdWriteTimestamp(START)</text>
    <text x="40" y="110" font-size="11" font-family="monospace" fill="#7f8c8d">// ... render pass ...</text>
    <text x="40" y="125" font-size="11" font-family="monospace" fill="#7f8c8d">vkCmdWriteTimestamp(END)</text>
    <text x="30" y="150" font-size="12" fill="#2c3e50">• Pipeline statistics queries:</text>
    <text x="40" y="170" font-size="11" fill="#7f8c8d">Vertex count, primitive count,</text>
    <text x="40" y="185" font-size="11" fill="#7f8c8d">shader invocations, etc.</text>
    <text x="30" y="210" font-size="12" fill="#2c3e50">• GPU markers (RenderDoc, Nsight):</text>
    <text x="40" y="230" font-size="11" font-family="monospace" fill="#27ae60">vkCmdBeginDebugUtilsLabel("GBuffer")</text>
  </g>
  
  <!-- Validation layers -->
  <g transform="translate(680, 3660)">
    <rect x="0" y="0" width="600" height="280" fill="#fff" stroke="#34495e" stroke-width="2" rx="6"/>
    <text x="300" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#2c3e50">
      Validation &amp; Debug
    </text>
    
    <rect x="20" y="50" width="560" height="210" fill="#ecf0f1" stroke="#34495e" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="12" fill="#2c3e50">• VK_LAYER_KHRONOS_validation:</text>
    <text x="40" y="95" font-size="11" fill="#e74c3c">Catches API misuse, memory errors</text>
    <text x="30" y="120" font-size="12" fill="#2c3e50">• GPU-Assisted Validation:</text>
    <text x="40" y="140" font-size="11" fill="#e74c3c">Shader buffer overruns, null checks</text>
    <text x="30" y="165" font-size="12" fill="#2c3e50">• Synchronization Validation:</text>
    <text x="40" y="185" font-size="11" fill="#e74c3c">Missing barriers, race conditions</text>
    <text x="30" y="210" font-size="12" fill="#2c3e50">• Best Practices Validation:</text>
    <text x="40" y="230" font-size="11" fill="#f39c12">Performance warnings, optimal usage</text>
  </g>
  
  <!-- Tools -->
  <g transform="translate(1300, 3660)">
    <rect x="0" y="0" width="640" height="280" fill="#fff" stroke="#34495e" stroke-width="2" rx="6"/>
    <text x="320" y="30" font-size="16" font-weight="bold" text-anchor="middle" fill="#2c3e50">
      Debugging Tools
    </text>
    
    <rect x="20" y="50" width="600" height="210" fill="#ecf0f1" stroke="#34495e" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="13" font-weight="bold" fill="#2980b9">RenderDoc:</text>
    <text x="40" y="95" font-size="11" fill="#2c3e50">Frame capture, resource inspection,</text>
    <text x="40" y="110" font-size="11" fill="#2c3e50">pipeline state, shader debugging</text>
    
    <text x="30" y="135" font-size="13" font-weight="bold" fill="#27ae60">NVIDIA Nsight Graphics:</text>
    <text x="40" y="155" font-size="11" fill="#2c3e50">GPU trace, bottleneck analysis,</text>
    <text x="40" y="170" font-size="11" fill="#2c3e50">warp occupancy, memory throughput</text>
    
    <text x="30" y="195" font-size="13" font-weight="bold" fill="#e74c3c">AMD Radeon GPU Profiler:</text>
    <text x="40" y="215" font-size="11" fill="#2c3e50">Frame analysis, shader performance,</text>
    <text x="40" y="230" font-size="11" fill="#2c3e50">wavefront occupancy</text>
  </g>
  
  <!-- ===== OPTIMIZATION STRATEGIES ===== -->
  <rect x="30" y="4000" width="1940" height="460" fill="#e8f8f0" stroke="#27ae60" stroke-width="3" rx="10"/>
  <text x="1000" y="4040" font-size="26" font-weight="bold" text-anchor="middle" fill="#229954">
    OPTIMIZATION STRATEGIES
  </text>
  
  <!-- CPU optimizations -->
  <g transform="translate(60, 4070)">
    <rect x="0" y="0" width="920" height="360" fill="#fff" stroke="#27ae60" stroke-width="2" rx="6"/>
    <text x="460" y="30" font-size="18" font-weight="bold" text-anchor="middle" fill="#229954">
      CPU Optimizations
    </text>
    
    <rect x="20" y="50" width="880" height="290" fill="#ecf0f1" stroke="#27ae60" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="13" font-weight="bold" fill="#2c3e50">Command Buffer Management:</text>
    <text x="40" y="95" font-size="11" fill="#2c3e50">• Pre-record static command buffers</text>
    <text x="40" y="110" font-size="11" fill="#2c3e50">• Use secondary command buffers for parallel recording</text>
    <text x="40" y="125" font-size="11" fill="#2c3e50">• Batch vkCmd calls, minimize state changes</text>
    
    <text x="30" y="150" font-size="13" font-weight="bold" fill="#2c3e50">Descriptor Management:</text>
    <text x="40" y="170" font-size="11" fill="#2c3e50">• Large descriptor pools (reduce allocations)</text>
    <text x="40" y="185" font-size="11" fill="#2c3e50">• Update descriptors only when needed</text>
    <text x="40" y="200" font-size="11" fill="#2c3e50">• VK_DESCRIPTOR_BINDING_PARTIALLY_BOUND</text>
    
    <text x="30" y="225" font-size="13" font-weight="bold" fill="#2c3e50">Multi-threading:</text>
    <text x="40" y="245" font-size="11" fill="#2c3e50">• Parallel command buffer recording</text>
    <text x="40" y="260" font-size="11" fill="#2c3e50">• Job system for scene updates</text>
    <text x="40" y="275" font-size="11" fill="#2c3e50">• Lock-free data structures</text>
    
    <text x="30" y="300" font-size="13" font-weight="bold" fill="#2c3e50">Memory:</text>
    <text x="40" y="320" font-size="11" fill="#2c3e50">• Use VMA for efficient allocation</text>
    <text x="40" y="335" font-size="11" fill="#2c3e50">• Pool allocators for frequent allocations</text>
  </g>
  
  <!-- GPU optimizations -->
  <g transform="translate(1000, 4070)">
    <rect x="0" y="0" width="940" height="360" fill="#fff" stroke="#27ae60" stroke-width="2" rx="6"/>
    <text x="470" y="30" font-size="18" font-weight="bold" text-anchor="middle" fill="#229954">
      GPU Optimizations
    </text>
    
    <rect x="20" y="50" width="900" height="290" fill="#ecf0f1" stroke="#27ae60" stroke-width="1" rx="4"/>
    <text x="30" y="75" font-size="13" font-weight="bold" fill="#2c3e50">Draw Call Reduction:</text>
    <text x="40" y="95" font-size="11" fill="#2c3e50">• GPU-driven rendering (multi-draw indirect)</text>
    <text x="40" y="110" font-size="11" fill="#2c3e50">• Instancing for repeated geometry</text>
    <text x="40" y="125" font-size="11" fill="#2c3e50">• Mesh shaders (amplification + mesh)</text>
    
    <text x="30" y="150" font-size="13" font-weight="bold" fill="#2c3e50">Culling:</text>
    <text x="40" y="170" font-size="11" fill="#2c3e50">• Depth pre-pass + early-Z rejection</text>
    <text x="40" y="185" font-size="11" fill="#2c3e50">• Hi-Z occlusion culling (GPU compute)</text>
    <text x="40" y="200" font-size="11" fill="#2c3e50">• Frustum culling on GPU</text>
    <text x="40" y="215" font-size="11" fill="#2c3e50">• LOD system (distance-based)</text>
    
    <text x="30" y="240" font-size="13" font-weight="bold" fill="#2c3e50">Bandwidth Optimization:</text>
    <text x="40" y="260" font-size="11" fill="#2c3e50">• Compressed textures (BC7, ASTC)</text>
    <text x="40" y="275" font-size="11" fill="#2c3e50">• Render target formats (R11G11B10F for HDR)</text>
    <text x="40" y="290" font-size="11" fill="#2c3e50">• Tiled rendering awareness</text>
    
    <text x="30" y="315" font-size="13" font-weight="bold" fill="#2c3e50">Async Compute:</text>
    <text x="40" y="335" font-size="11" fill="#2c3e50">• Overlap compute with graphics</text>
  </g>
  
  <!-- Arrow markers -->
  <defs>
    <marker id="arrow-red" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#e74c3c"/>
    </marker>
    <marker id="arrow-gray" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#7f8c8d"/>
    </marker>
  </defs>
</svg>
